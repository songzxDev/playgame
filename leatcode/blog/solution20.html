<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>题目20-有效的括号</title>
    <link rel="stylesheet" href="../highlight/styles/darcula.css">
    <style>
        .gird-item {
            width: 50px;
            height: 50px;
            line-height: 50px;
            text-align: center;
            border: 1px solid #cccccc;
            margin: 5px;
        }
    </style>
    <script src="../highlight/highlight.pack.js"></script>
</head>
<body>
<div>
    <input id="strIpt" type="text" style="width: 300px; margin-left: 10px; " required value="{}()[]">
    <button id="execStepBtn" style="margin-left: 20px;" onclick="execStepBtnClick()">下一步</button>

</div>
<div style="display: flex;">
    <div style="width: 50%;">
        <div id="targetStr" style="margin: 10px; display: flex; flex-direction: row;"></div>
        <div id="stackItems"
             style="margin: 10px; display: flex; flex-direction: column-reverse; border: 1px solid #cccccc"></div>
        <div id="oldItems"
             style="margin: 10px; display: flex; flex-direction: row; align-items: center; height: 100px; border: 1px solid #cccccc"></div>
    </div>
    <div style="width: 50%;">
<pre style="margin: 10px; font-size: 15px;">
<code class="javascript">
/**
 * 题目：20.有效的括号
 * 标签：字符串 栈
 * @param {string} s
 * @return {boolean}
 */
const isValid = (str) => {
    let stack = [];
    for (let s of str) {
        if (s === '(') {
            stack.push(')');
        } else if (s === '[') {
            stack.push(']');
        } else if (s === '{') {
            stack.push('}');
        } else if (stack.length === 0 || stack.pop() !== s) {
            return false;
        }
    }
    return stack.length === 0;
};
</code>
</pre>
    </div>
</div>
<script>
    let step = 1;
    let execStepBtnClick = () => {
        let str = document.getElementById('strIpt').value;
        if (!str) return step;
        step = (Number.isNaN(step) ? 0 : step) % str.length + 1;
        targetStr.innerHTML = "";
        for (let i = 0; i < str.length; i++) {
            createGird(targetStr, str.charAt(i));
        }
        isValid(str, step);
        return step;
    };
    let createGird = (parent, s) => {
        let item = document.createElement('div');
        item.classList.add('gird-item');
        item.innerText = s;
        return parent.appendChild(item);
    };

    let renderCurrS = (parent, childIdx, borderStyle) => {
        parent.childNodes[childIdx].style.border = borderStyle;
        return parent.childNodes;
    }
</script>
<script>
    let [targetStr, stackItems, oldItems] = [document.getElementById('targetStr'),
        document.getElementById('stackItems'), document.getElementById('oldItems')];

    const isValid = (str, step) => {
        let stack = [];
        stackItems.innerHTML = "";
        oldItems.innerHTML = "";
        for (let i = 0; i < step && i < str.length; i++) {
            let s = str.charAt(i);
            renderCurrS(targetStr, i, "2px solid blue");
            if (s === '(') {
                stack.push(')');
                createGird(stackItems, stack[stack.length - 1]);
            } else if (s === '[') {
                stack.push(']');
                createGird(stackItems, stack[stack.length - 1]);
            } else if (s === '{') {
                stack.push('}');
                createGird(stackItems, stack[stack.length - 1]);
            } else if (stack.length === 0 || stack.pop() !== s) {
                renderCurrS(targetStr, i, "2px solid red");
                return false;
            } else if (stackItems.hasChildNodes()) {
                let oldChild = stackItems.removeChild(stackItems.lastChild);
                oldChild.style.border = "2px solid red";
                oldItems.appendChild(oldChild);
            }
        }
        return stack.length === 0;
    };
    document.addEventListener('DOMContentLoaded', (event) => {
        document.querySelectorAll('pre code').forEach((block) => {
            hljs.highlightBlock(block);
        });
    });
</script>
</body>
</html>